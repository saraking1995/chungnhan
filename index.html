<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chứng Nhận Hoàn Thành Xuất Sắc</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Merriweather:wght@400;700&display=swap');
        
        /* --- Nền và Bố cục --- */
        body {
            font-family: 'Merriweather', serif;
            background-color: #f0f2f5;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4d7de' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        /* --- Khung chính của chứng nhận --- */
        #certificateContainer {
            background-color: #ffffff;
            border: 1px solid #d1d5db;
            position: relative;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1), 0 0 0 10px #ffffff;
            overflow: hidden;
        }
        
        /* --- Đường viền trang trí kép --- */
        #certificateContainer::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 3px double #b49b63; /* Viền vàng gold */
            z-index: 1;
        }
        
        /* --- Kiểu chữ (Typography) --- */
        .font-title {
            font-family: 'Playfair Display', serif;
        }

    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-8">

    <div class="w-full max-w-5xl">
        <div id="certificateContainer" class="p-12">
            
            <div class="relative z-10">
                <div class="text-center mb-8">
                    <h1 class="font-title text-3xl font-bold text-gray-800 tracking-wider">CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</h1>
                    <p class="text-xl font-bold text-gray-700 tracking-[0.2em]">Độc lập - Tự do - Hạnh phúc</p>
                    <div class="w-48 h-0.5 bg-yellow-600 mx-auto mt-4"></div>
                </div>

                <div class="text-center mb-12">
                    <h2 class="font-title text-6xl font-bold text-blue-900">CHỨNG NHẬN</h2>
                    <h3 class="text-2xl font-semibold text-blue-800 mt-2">HOÀN THÀNH XUẤT SẮC NHIỆM VỤ</h3>
                </div>

                <div class="text-center text-xl leading-relaxed max-w-3xl mx-auto">
                    <p class="mb-4">Trân trọng trao tặng các đồng chí:</p>
                    
                    <div id="recipientsList" class="my-8 font-bold text-3xl text-blue-800" style="font-family: 'Playfair Display', serif;">
                        <p id="loadingText" class="text-xl font-sans">Đang tải danh sách...</p>
                    </div>
                    
                    <p>Đã có thành tích đặc biệt xuất sắc trong công tác, góp phần vào sự thành công chung của đơn vị trong tháng <b id="displayMonth" class="text-blue-900"></b>.</p>
                </div>

                <div class="flex justify-end mt-24">
                    <div class="text-center">
                        <p id="displayDate" class="font-semibold text-gray-800 mb-2"></p>
                        <p class="font-title font-bold text-gray-800 text-xl tracking-wider mb-16">ĐỘI TRƯỞỞNG</p>
                        <p class="font-title font-bold text-gray-800 text-2xl">Nguyễn Đức Nghĩa</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // !!! THAY THẾ BẰNG URL WEB APP CỦA BẠN !!!
            const API_URL = 'https://script.google.com/macros/s/AKfycbx41P3z79Y-1FzYsek-Tls9zffdIOfy5w4x36im4-51uFNnJyTZ5Jb-uYjah2nQ9sG7/exec';

            const listContainer = document.getElementById('recipientsList');
            const loadingText = document.getElementById('loadingText');

            fetch(API_URL)
                .then(response => response.json())
                .then(names => {
                    if (names && names.length > 0) {
                        loadingText.remove();
                        const nameListString = names.join('<br>');
                        listContainer.innerHTML = nameListString;
                    } else {
                        loadingText.textContent = 'Không có đồng chí nào trong danh sách.';
                    }
                })
                .catch(error => {
                    console.error('Lỗi khi tải dữ liệu:', error);
                    loadingText.textContent = 'Không thể tải được danh sách.';
                    loadingText.classList.add('text-red-500');
                });

            const now = new Date();
            document.getElementById('displayMonth').textContent = (now.getMonth() + 1) + '/' + now.getFullYear();
            document.getElementById('displayDate').textContent = `Ngày ${now.getDate()}, tháng ${now.getMonth() + 1}, năm ${now.getFullYear()}`;
        });
    </script>
</body>
</html>
