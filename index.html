<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhập Thông Tin Chứng Nhận - Đội Khám nghiệm hiện trường</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800">Hệ thống Tạo Chứng Nhận</h1>
                <p class="text-xl text-gray-600">Đội Khám nghiệm hiện trường</p>
            </div>
            <form id="certificateForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Danh sách đồng chí *</label>
                    <div id="recipientsList" class="space-y-3 mb-4">
                        <div class="recipient-item flex items-center space-x-3">
                            <input type="text" class="recipient-name flex-1 px-4 py-3 border border-gray-300 rounded-lg" placeholder="Nhập họ và tên đầy đủ" required>
                            <button type="button" onclick="removeRecipient(this)" class="hidden bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg">&times;</button>
                        </div>
                    </div>
                    <button type="button" onclick="addRecipient()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg">Thêm đồng chí</button>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Tháng *</label>
                    <input type="month" id="month" required class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Thành tích nổi bật *</label>
                    <textarea id="achievements" required rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Mô tả chi tiết..."></textarea>
                </div>
                <div class="flex justify-center space-x-4 pt-6">
                    <button type="button" onclick="generateCertificate()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg">Tạo chứng nhận</button>
                    <button type="button" onclick="resetForm()" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-8 rounded-lg">Làm mới</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('month').value = new Date().toISOString().slice(0, 7);
            updateRemoveButtons();
        });

        function generateCertificate() {
            const form = document.getElementById('certificateForm');
            if (!form.checkValidity()) { form.reportValidity(); return; }

            const recipients = Array.from(document.querySelectorAll('.recipient-name')).map(i => i.value.trim()).filter(n => n !== '');
            if (recipients.length === 0) { alert('Vui lòng nhập ít nhất một tên đồng chí!'); return; }

            const data = {
                names: recipients,
                month: document.getElementById('month').value,
                achievements: document.getElementById('achievements').value,
                unit: 'Đội Khám nghiệm hiện trường',
                presenter: 'Nguyễn Đức Nghĩa'
            };
            
            const encodedData = btoa(unescape(encodeURIComponent(JSON.stringify(data))));
            
            const targetUrl = `https://saraking1995.github.io/chungnhan/giaychungnhan/#${encodedData}`;
            window.open(targetUrl, '_blank');
        }

        function resetForm() {
            document.getElementById('certificateForm').reset();
            const list = document.getElementById('recipientsList');
            list.innerHTML = `<div class="recipient-item flex items-center space-x-3"><input type="text" class="recipient-name flex-1 px-4 py-3 border border-gray-300 rounded-lg" placeholder="Nhập họ và tên đầy đủ" required><button type="button" onclick="removeRecipient(this)" class="hidden bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg">&times;</button></div>`;
            document.getElementById('month').value = new Date().toISOString().slice(0, 7);
            updateRemoveButtons();
        }

        function addRecipient() {
            const list = document.getElementById('recipientsList');
            const item = document.createElement('div');
            item.className = 'recipient-item flex items-center space-x-3';
            item.innerHTML = `<input type="text" class="recipient-name flex-1 px-4 py-3 border border-gray-300 rounded-lg" placeholder="Nhập họ và tên đầy đủ" required><button type="button" onclick="removeRecipient(this)" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg">&times;</button>`;
            list.appendChild(item);
            updateRemoveButtons();
        }

        function removeRecipient(button) {
            button.closest('.recipient-item').remove();
            updateRemoveButtons();
        }

        function updateRemoveButtons() {
            const items = document.querySelectorAll('.recipient-item');
            items.forEach(item => {
                const button = item.querySelector('button');
                if (button) button.classList.toggle('hidden', items.length === 1);
            });
        }
    </script>
</body>
</html>
